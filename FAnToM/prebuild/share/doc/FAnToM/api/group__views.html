<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FAnToM: Linked Views</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="FAnToM-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FAnToM
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">scientific visualization and analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Linked Views</div>  </div>
</div><!--header-->
<div class="contents">

<p>This part of the tutorial shows how to create an interaction algorithm that uses multiple, linked views. Also, some very relevant issues on threading and data synchronization between the views are discussed. For information concerning the initialization of algorithm windows and GUI elements please refer to the <a class="el" href="group__GUI.html">GUI elements</a> tutorial.  
<a href="#details">More...</a></p>
<p>This part of the tutorial shows how to create an interaction algorithm that uses multiple, linked views. Also, some very relevant issues on threading and data synchronization between the views are discussed. For information concerning the initialization of algorithm windows and GUI elements please refer to the <a class="el" href="group__GUI.html">GUI elements</a> tutorial. </p>
<div class="fragment"><div class="line"><span class="comment">// TODO: add new linked views Tutorial here</span></div>
<div class="line"><span class="preprocessor">#if 0</span></div>
<div class="line"><span class="preprocessor">#include &lt;mutex&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fantom/algorithm.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fantom/graphics.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fantom/graphics2D.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fantom/gui.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fantom/register.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacefantom.html">fantom</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line">    std::vector&lt; Color &gt; colorScheme1{</div>
<div class="line">        <a class="code" href="classfantom_1_1Color.html">Color</a>( 1.0, 0.0, 0.0 ), <a class="code" href="classfantom_1_1Color.html">Color</a>( 0.0, 1.0, 0.0 ), <a class="code" href="classfantom_1_1Color.html">Color</a>( 0.0, 0.0, 1.0 ), <a class="code" href="classfantom_1_1Color.html">Color</a>( 0.0, 0.0, 0.0 )</div>
<div class="line">    };</div>
<div class="line">    std::vector&lt; Color &gt; colorScheme2{</div>
<div class="line">        <a class="code" href="classfantom_1_1Color.html">Color</a>( 1.0, 1.0, 0.0 ), <a class="code" href="classfantom_1_1Color.html">Color</a>( 1.0, 0.0, 1.0 ), <a class="code" href="classfantom_1_1Color.html">Color</a>( 0.0, 1.0, 1.0 ), <a class="code" href="classfantom_1_1Color.html">Color</a>( 1.0, 1.0, 1.0 )</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>ViewTutorialAlgorithm : <span class="keyword">public</span> <a class="code" href="classfantom_1_1InteractionAlgorithm.html">InteractionAlgorithm</a></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">class </span>ViewScene : <span class="keyword">public</span> <a class="code" href="classfantom_1_1Graphics2D_1_1ScenePainter.html">Graphics2D::ScenePainter</a></div>
<div class="line">        {</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            ViewScene()</div>
<div class="line">                : mC1( *this )</div>
<div class="line">                , mC2( *this )</div>
<div class="line">                , mC3( *this )</div>
<div class="line">                , mC4( *this )</div>
<div class="line">            {</div>
<div class="line">                mC1.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 0, 0 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">                mC2.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 30, 0 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">                mC3.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 0, 30 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">                mC4.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 30, 30 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> setColors( std::vector&lt; Color &gt; colors )</div>
<div class="line">            {</div>
<div class="line">                mColors = colors;</div>
<div class="line">                mC1.setFillColor( mColors[0] );</div>
<div class="line">                mC2.setFillColor( mColors[1] );</div>
<div class="line">                mC3.setFillColor( mColors[2] );</div>
<div class="line">                mC4.setFillColor( mColors[3] );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">bool</span> mousePress( <span class="keyword">const</span> MouseEvent&amp; event )<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">            </span>{</div>
<div class="line">                <span class="keywordflow">if</span>( event.getButton() != MouseButton::Left || !mCallback )</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="classfantom_1_1Tensor.html">Point2F</a> pos = this-&gt;getSceneCoordinates( event.getPosition() );</div>
<div class="line">                std::vector&lt; Graphics2D::Item* &gt; items = this-&gt;getItemsAtCoord( pos );</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span>( <a class="code" href="classfantom_1_1Graphics2D_1_1Item.html">Graphics2D::Item</a>* item : items )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span>( item == &amp;mC1 )</div>
<div class="line">                        mCallback( 0 );</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( item == &amp;mC2 )</div>
<div class="line">                        mCallback( 1 );</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( item == &amp;mC3 )</div>
<div class="line">                        mCallback( 2 );</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( item == &amp;mC4 )</div>
<div class="line">                        mCallback( 3 );</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> setColorChosenCallback( std::function&lt; <span class="keywordtype">void</span>( <span class="keywordtype">size_t</span> ) &gt; callback )</div>
<div class="line">            {</div>
<div class="line">                mCallback = callback;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">            <a class="code" href="classfantom_1_1Graphics2D_1_1Polygon.html">Graphics2D::Polygon</a> mC1;</div>
<div class="line">            <a class="code" href="classfantom_1_1Graphics2D_1_1Polygon.html">Graphics2D::Polygon</a> mC2;</div>
<div class="line">            <a class="code" href="classfantom_1_1Graphics2D_1_1Polygon.html">Graphics2D::Polygon</a> mC3;</div>
<div class="line">            <a class="code" href="classfantom_1_1Graphics2D_1_1Polygon.html">Graphics2D::Polygon</a> mC4;</div>
<div class="line"> </div>
<div class="line">            std::vector&lt; Color &gt; mColors;</div>
<div class="line">            std::function&lt; void( <span class="keywordtype">size_t</span> ) &gt; mCallback;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">class </span><a class="code" href="classfantom_1_1Options.html">Options</a> : <span class="keyword">public</span> <a class="code" href="classfantom_1_1Algorithm.html#afd2cdec3a4e63e05e3f7003b656845b3">InteractionAlgorithm::Options</a></div>
<div class="line">        {</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            <a class="code" href="classfantom_1_1Options.html">Options</a>( Control&amp; control )</div>
<div class="line">                : <a class="code" href="classfantom_1_1InteractionAlgorithm.html">InteractionAlgorithm</a>::<a class="code" href="classfantom_1_1Options.html">Options</a>( control )</div>
<div class="line">            {</div>
<div class="line">                add&lt; InputChoices &gt;(</div>
<div class="line">                    <span class="stringliteral">&quot;Color Scheme&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, std::vector&lt; std::string &gt;{ <span class="stringliteral">&quot;Scheme 1&quot;</span>, <span class="stringliteral">&quot;Scheme 2&quot;</span> }, <span class="stringliteral">&quot;Scheme 1&quot;</span> );</div>
<div class="line"> </div>
<div class="line">                add&lt; size_t &gt;( <span class="stringliteral">&quot;choice&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0 );</div>
<div class="line">                setVisible( <span class="stringliteral">&quot;choice&quot;</span>, <span class="keyword">false</span> );</div>
<div class="line">            }</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">class </span><a class="code" href="classfantom_1_1VisOutputs.html">VisOutputs</a> : <span class="keyword">public</span> <a class="code" href="classfantom_1_1VisOutputs.html">InteractionAlgorithm::VisOutputs</a></div>
<div class="line">        {</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            <a class="code" href="classfantom_1_1VisOutputs.html">VisOutputs</a>( Control&amp; control )</div>
<div class="line">                : <a class="code" href="classfantom_1_1InteractionAlgorithm.html">InteractionAlgorithm</a>::<a class="code" href="classfantom_1_1VisOutputs.html">VisOutputs</a>( control )</div>
<div class="line">            {</div>
<div class="line">                addGraphics( <span class="stringliteral">&quot;Graphics&quot;</span> );</div>
<div class="line">                add2DScene&lt; ViewScene &gt;( <span class="stringliteral">&quot;ChoiceDialog&quot;</span> );</div>
<div class="line">            }</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">class </span>Interactions : <span class="keyword">public</span> <a class="code" href="classfantom_1_1InteractionAlgorithm_1_1Interactions.html">InteractionAlgorithm::Interactions</a></div>
<div class="line">        {</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            Interactions( <a class="code" href="classfantom_1_1Algorithm_1_1InitData.html">Algorithm::InitData</a>&amp; init )</div>
<div class="line">                : <a class="code" href="classfantom_1_1InteractionAlgorithm.html">InteractionAlgorithm</a>::Interactions( init )</div>
<div class="line">                , mScene( get2DScene&lt; ViewScene &gt;( <span class="stringliteral">&quot;ChoiceDialog&quot;</span> ) )</div>
<div class="line">            {</div>
<div class="line">                mScene.setColorChosenCallback( std::bind( &amp;Interactions::colorChosen, <span class="keyword">this</span>, std::placeholders::_1 ) );</div>
<div class="line">                mScene.setColors( getOptions().get&lt; std::string &gt;( <span class="stringliteral">&quot;Color Scheme&quot;</span> ) == <span class="stringliteral">&quot;Scheme 1&quot;</span> ? colorScheme1 :</div>
<div class="line">                                                                                                    colorScheme2 );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> optionChanged( <span class="keyword">const</span> std::string&amp; name )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( name == <span class="stringliteral">&quot;Color Scheme&quot;</span> )</div>
<div class="line">                {</div>
<div class="line">                    mScene.setColors( getOptions().get&lt; std::string &gt;( <span class="stringliteral">&quot;Color Scheme&quot;</span> ) == <span class="stringliteral">&quot;Scheme 1&quot;</span> ? colorScheme1 :</div>
<div class="line">                                                                                                        colorScheme2 );</div>
<div class="line">                }</div>
<div class="line">                requestAlgoRun();</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> colorChosen( <span class="keywordtype">size_t</span> index )</div>
<div class="line">            {</div>
<div class="line">                getOptions().set&lt; <span class="keywordtype">size_t</span> &gt;( <span class="stringliteral">&quot;choice&quot;</span>, index );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">            ViewScene&amp; mScene;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        ViewTutorialAlgorithm( InitData&amp; data )</div>
<div class="line">            : <a class="code" href="classfantom_1_1InteractionAlgorithm.html">InteractionAlgorithm</a>( data )</div>
<div class="line">        {</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">void</span> execute( <span class="keyword">const</span> <a class="code" href="classfantom_1_1Options.html">Algorithm::Options</a>&amp; options, <span class="keyword">const</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span>&amp; <span class="comment">/*abortFlag*/</span> )<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">        </span>{</div>
<div class="line">            mGeom = getGraphics( <span class="stringliteral">&quot;Graphics&quot;</span> ).makePrimitive();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">size_t</span> index = options.<a class="code" href="classfantom_1_1Options.html#ae454b0a66e9ddbde305ef9ec099b34b9">get</a>&lt; <span class="keywordtype">size_t</span> &gt;( <span class="stringliteral">&quot;choice&quot;</span> );</div>
<div class="line">            <span class="keyword">const</span> std::vector&lt; Color &gt; scheme</div>
<div class="line">                = options.<a class="code" href="classfantom_1_1Options.html#ae454b0a66e9ddbde305ef9ec099b34b9">get</a>&lt; std::string &gt;( <span class="stringliteral">&quot;Color Scheme&quot;</span> ) == <span class="stringliteral">&quot;Scheme 1&quot;</span> ? colorScheme1 : colorScheme2;</div>
<div class="line">            <span class="keywordflow">if</span>( scheme.empty() )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            mGeom-&gt;addSphere( <a class="code" href="group__math.html#gad8125119640f66e3b4101948fab706b8">Point3</a>( 0.0, 0.0, 0.0 ), 1.0, scheme[index] );</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">        std::unique_ptr&lt; Primitive &gt; mGeom;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classfantom_1_1AlgorithmRegister.html">AlgorithmRegister&lt; ViewTutorialAlgorithm &gt;</a> dummy( <span class="stringliteral">&quot;Tutorial/Views&quot;</span>, <span class="stringliteral">&quot;Demonstrate the use of algorithm views.&quot;</span> );</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><p>When started, the algorithm opens a little window with some colored rectangles. The window may be moved around and also docked inside the main FAnToM window. When a colored rectangle is clicked, the color of the three-dimensional sphere changes. It is also possible to select a different set of available colors via the algorithm options.</p>
<p>The purpose of this tutorial is to show how information and events can be exchanged between algorithm and view and vice versa and how costly computations can be offloaded to the algorithm thread.</p>
<p>There are no restrictions on how views have to be created or what they contain. In our case, we want to display an interactive 2D scene, so the first step is to create a <em>ScenePainter</em> for it.</p>
<div class="fragment"><div class="line">        <span class="keyword">class </span>ViewScene : <span class="keyword">public</span> Graphics2D::ScenePainter</div>
<div class="line">        {</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            ViewScene()</div>
<div class="line">                : mC1( *this )</div>
<div class="line">                , mC2( *this )</div>
<div class="line">                , mC3( *this )</div>
<div class="line">                , mC4( *this )</div>
<div class="line">            {</div>
<div class="line">                mC1.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 0, 0 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">                mC2.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 30, 0 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">                mC3.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 0, 30 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">                mC4.setRect( <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 30, 30 ), <a class="code" href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">Point2F</a>( 20, 20 ) );</div>
<div class="line">            }</div>
</div><!-- fragment --><p>This creates a small scene consisting of four colored rectangles.</p>
<div class="fragment"><div class="line">            <span class="keywordtype">bool</span> mousePress( <span class="keyword">const</span> MouseEvent&amp; event ) <span class="keyword">override</span></div>
<div class="line">            {</div>
</div><!-- fragment --><p> [...] </p><div class="fragment"><div class="line">                        mCallback( 0 );</div>
<div class="line">                }</div>
<div class="line">            <span class="keywordtype">void</span> setColorChosenCallback( std::function&lt; <span class="keywordtype">void</span>( <span class="keywordtype">size_t</span> ) &gt; callback )</div>
<div class="line">            std::function&lt; void( <span class="keywordtype">size_t</span> ) &gt; mCallback;</div>
</div><!-- fragment --><p>The mousePress function is called when mouse press events occur within the <em>ScenePainter</em>. This code always runs in the GUI thread and should be fast! When data members of the view change in reaction to user interaction and other views need to be updated, the change has to be made public somehow. However, the algorithm instance or other views are not known to the scene for various reasons (e.g., module encapsulation or chicken-and-egg problems with instantiating the views). Thus, the best approach for passing data elsewhere is to use callback functions. We assume, that everyone who registers a callback function, knows that it will be called from the GUI thread and installs synchronization if necessary. Thereby, ensure that you hold the locks for as short a time as possible, to prevent the GUI thread from being stalled too long.</p>
<div class="fragment"><div class="line">        <span class="keyword">class </span>VisOutputs : <span class="keyword">public</span> InteractionAlgorithm::VisOutputs</div>
<div class="line">        {</div>
<div class="line">                addGraphics( <span class="stringliteral">&quot;Graphics&quot;</span> );</div>
<div class="line">                add2DScene&lt; ViewScene &gt;( <span class="stringliteral">&quot;ChoiceDialog&quot;</span> );</div>
<div class="line">        };</div>
</div><!-- fragment --><p>All views of the algorithm are declared in the VisOutputs. Here, we have a 3D graphics output and the 2D graphics scene that we defined above. The scene shows an interactive dialog to allow for choosing certain options more conveniently. Such interactions should trigger the execute() method of the algorithm. There, "costly" computations are performed and the results displayed in the 3D graphics output. Note, that no algorithm window needs to be instantiated. It is sufficient to declare the ScenePainter as a 2D scene for the algorithm.</p>
<div class="fragment"><div class="line">        <span class="keyword">class </span>Interactions : <span class="keyword">public</span> InteractionAlgorithm::Interactions</div>
<div class="line">        {</div>
<div class="line">                mScene.setColorChosenCallback( std::bind( &amp;Interactions::colorChosen, <span class="keyword">this</span>, std::placeholders::_1 ) );</div>
<div class="line">                mScene.setColors( getOptions().get&lt; std::string &gt;( <span class="stringliteral">&quot;Color Scheme&quot;</span> ) == <span class="stringliteral">&quot;Scheme 1&quot;</span> ? colorScheme1 :</div>
<div class="line">            }</div>
</div><!-- fragment --><p>The Interactions class is the central control unit for interactive algorithms. It is instantiated after the visual outputs, but before the algorithm, and has access to all parts of the algorithm. All events from the views should be processed here. Therefore, the Interactions object registers one of its methods as the callback function in the ViewScene.</p>
<div class="fragment"><div class="line">            <span class="keywordtype">void</span> optionChanged( <span class="keyword">const</span> std::string&amp; name )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>( name == <span class="stringliteral">&quot;Color Scheme&quot;</span> )</div>
<div class="line">                {</div>
<div class="line">                    mScene.setColors( getOptions().get&lt; std::string &gt;( <span class="stringliteral">&quot;Color Scheme&quot;</span> ) == <span class="stringliteral">&quot;Scheme 1&quot;</span> ? colorScheme1 :</div>
<div class="line">                                                                                                        colorScheme2 );</div>
<div class="line">                }</div>
<div class="line">                requestAlgoRun();</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> colorChosen( <span class="keywordtype">size_t</span> index )</div>
<div class="line">            {</div>
<div class="line">                getOptions().set&lt; <span class="keywordtype">size_t</span> &gt;( <span class="stringliteral">&quot;choice&quot;</span>, index );</div>
<div class="line">            }</div>
</div><!-- fragment --><p>These two methods define all interactions of the algorithm. When an option changes (there are options for the set of colors available and for the index of the chosen color), the view is updated to reflect the change. Also, FAnToM is requested to run the execute() method of the algorithm, so that computations with the changed options can be performed.</p>
<p>The second function, colorChosen(), was registered as the callback for selections in the view. When the user clicks a rectangle in the view, this is notified to the callback, which changes the algorithm options accordingly. The changed options then result in an updated view and a run of the execute() method. This approach seems overdone at first, but it has a critical advantage: every user interaction is also represented in the algorithm options. This may be visible (as in this case), but also hidden options can be used. As a consequence, the user interactions are stored within the session files and can be restored later.</p>
<div class="fragment"><div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">void</span> execute( <span class="keyword">const</span> Algorithm::Options&amp; options, <span class="keyword">const</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span>&amp; <span class="comment">/*abortFlag*/</span> ) <span class="keyword">override</span></div>
<div class="line">        {</div>
<div class="line">            mGeom = getGraphics( <span class="stringliteral">&quot;Graphics&quot;</span> ).makePrimitive();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">size_t</span> index = options.<a class="code" href="classfantom_1_1Options.html#ae454b0a66e9ddbde305ef9ec099b34b9">get</a>&lt; <span class="keywordtype">size_t</span> &gt;( <span class="stringliteral">&quot;choice&quot;</span> );</div>
<div class="line">            <span class="keyword">const</span> std::vector&lt; Color &gt; scheme</div>
<div class="line">                = options.<a class="code" href="classfantom_1_1Options.html#ae454b0a66e9ddbde305ef9ec099b34b9">get</a>&lt; std::string &gt;( <span class="stringliteral">&quot;Color Scheme&quot;</span> ) == <span class="stringliteral">&quot;Scheme 1&quot;</span> ? colorScheme1 : colorScheme2;</div>
<div class="line">            <span class="keywordflow">if</span>( scheme.empty() )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            mGeom-&gt;addSphere( <a class="code" href="group__math.html#gad8125119640f66e3b4101948fab706b8">Point3</a>( 0.0, 0.0, 0.0 ), 1.0, scheme[index] );</div>
<div class="line">        }</div>
</div><!-- fragment --><p>Costly computations should never be done within the GUI thread, because the complete application user interface is unresponsive during that time. Such computations should be offloaded to the algorithm thread.</p>
<p>In this simple case, all data needed for the computation is already present in the algorithm options. If that is not sufficient, it is possible to pass a reference to the Interactions object to the algorithm via the constructor. See InteractionAlgorithm::InteractionAlgorithm for details. The "costly" computation in this tutorial is just the generation of a graphics primitive. Since a 3D graphics object is accessed, which is thread safe, no extra synchronization is needed. In more sophisticated linked views, when also GUI elements have to be changed or 2D scenes have to be accessed, synchronization is mandatory. In such cases, you could use the signals and slots framework (see &lt;fantom/signals.hpp&gt;) to send the data to the GUI thread and have it processed there. </p>
</div><!-- contents -->
<div class="ttc" id="aclassfantom_1_1Color_html"><div class="ttname"><a href="classfantom_1_1Color.html">fantom::Color</a></div><div class="ttdoc">RGBA color.</div><div class="ttdef"><b>Definition:</b> math.hpp:1619</div></div>
<div class="ttc" id="aclassfantom_1_1InteractionAlgorithm_1_1Interactions_html"><div class="ttname"><a href="classfantom_1_1InteractionAlgorithm_1_1Interactions.html">fantom::InteractionAlgorithm::Interactions</a></div><div class="ttdef"><b>Definition:</b> algorithm.hpp:461</div></div>
<div class="ttc" id="aclassfantom_1_1AlgorithmRegister_html"><div class="ttname"><a href="classfantom_1_1AlgorithmRegister.html">fantom::AlgorithmRegister</a></div><div class="ttdoc">registers an algorithm at the kernel</div><div class="ttdef"><b>Definition:</b> algorithm.hpp:291</div></div>
<div class="ttc" id="aclassfantom_1_1InteractionAlgorithm_html"><div class="ttname"><a href="classfantom_1_1InteractionAlgorithm.html">fantom::InteractionAlgorithm</a></div><div class="ttdoc">base class of algorithms for user interaction</div><div class="ttdef"><b>Definition:</b> algorithm.hpp:293</div></div>
<div class="ttc" id="anamespacefantom_html"><div class="ttname"><a href="namespacefantom.html">fantom</a></div><div class="ttdoc">FAnToM API namespace.</div><div class="ttdef"><b>Definition:</b> main.dox:37</div></div>
<div class="ttc" id="aclassfantom_1_1Options_html_ae454b0a66e9ddbde305ef9ec099b34b9"><div class="ttname"><a href="classfantom_1_1Options.html#ae454b0a66e9ddbde305ef9ec099b34b9">fantom::Options::get</a></div><div class="ttdeci">input_detail::InputTypeTraits&lt; T &gt;::ValueType get(const std::string &amp;name) const</div><div class="ttdoc">Gives the value of an option.</div><div class="ttdef"><b>Definition:</b> options.hpp:590</div></div>
<div class="ttc" id="aclassfantom_1_1Algorithm_html_afd2cdec3a4e63e05e3f7003b656845b3"><div class="ttname"><a href="classfantom_1_1Algorithm.html#afd2cdec3a4e63e05e3f7003b656845b3">fantom::Algorithm::Options</a></div><div class="ttdeci">fantom::Options Options</div><div class="ttdoc">Base class for algorithm specific options.</div><div class="ttdef"><b>Definition:</b> algorithm.hpp:70</div></div>
<div class="ttc" id="aclassfantom_1_1Tensor_html"><div class="ttname"><a href="classfantom_1_1Tensor.html">fantom::Tensor&lt; float, 2 &gt;</a></div></div>
<div class="ttc" id="aclassfantom_1_1Graphics2D_1_1Polygon_html"><div class="ttname"><a href="classfantom_1_1Graphics2D_1_1Polygon.html">fantom::Graphics2D::Polygon</a></div><div class="ttdoc">arbitrary polygon</div><div class="ttdef"><b>Definition:</b> graphics2D.hpp:656</div></div>
<div class="ttc" id="aclassfantom_1_1Options_html"><div class="ttname"><a href="classfantom_1_1Options.html">fantom::Options</a></div><div class="ttdoc">base class of options</div><div class="ttdef"><b>Definition:</b> options.hpp:119</div></div>
<div class="ttc" id="aclassfantom_1_1Algorithm_1_1InitData_html"><div class="ttname"><a href="classfantom_1_1Algorithm_1_1InitData.html">fantom::Algorithm::InitData</a></div><div class="ttdoc">simple class for silently passing the private implementation...</div><div class="ttdef"><b>Definition:</b> algorithm.hpp:411</div></div>
<div class="ttc" id="aclassfantom_1_1Graphics2D_1_1ScenePainter_html"><div class="ttname"><a href="classfantom_1_1Graphics2D_1_1ScenePainter.html">fantom::Graphics2D::ScenePainter</a></div><div class="ttdef"><b>Definition:</b> graphics2D.hpp:623</div></div>
<div class="ttc" id="aclassfantom_1_1VisOutputs_html"><div class="ttname"><a href="classfantom_1_1VisOutputs.html">fantom::VisOutputs</a></div><div class="ttdoc">Visual outputs of algorithms.</div><div class="ttdef"><b>Definition:</b> VisOutputs.hpp:40</div></div>
<div class="ttc" id="agroup__math_html_gad8125119640f66e3b4101948fab706b8"><div class="ttname"><a href="group__math.html#gad8125119640f66e3b4101948fab706b8">fantom::Point3</a></div><div class="ttdeci">Tensor&lt; double, 3 &gt; Point3</div><div class="ttdoc">3-D point</div><div class="ttdef"><b>Definition:</b> math.hpp:769</div></div>
<div class="ttc" id="agroup__GUI_html_gaef23e77adc3fe85196b985a18e4fec22"><div class="ttname"><a href="group__GUI.html#gaef23e77adc3fe85196b985a18e4fec22">fantom::Point2F</a></div><div class="ttdeci">Tensor&lt; float, 2 &gt; Point2F</div><div class="ttdoc">2-D point with float precision</div><div class="ttdef"><b>Definition:</b> math.hpp:766</div></div>
<div class="ttc" id="aclassfantom_1_1Graphics2D_1_1Item_html"><div class="ttname"><a href="classfantom_1_1Graphics2D_1_1Item.html">fantom::Graphics2D::Item</a></div><div class="ttdoc">base class for 2D graphics items</div><div class="ttdef"><b>Definition:</b> graphics2D.hpp:480</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
