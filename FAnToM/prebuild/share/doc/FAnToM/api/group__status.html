<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FAnToM: Status Reporting</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="FAnToM-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FAnToM
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">scientific visualization and analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Status Reporting</div>  </div>
</div><!--header-->
<div class="contents">

<p>This part of the tutorial illustrates the basic abilities of algorithms to report status and ask the user simple questions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfantom_1_1Algorithm_1_1Progress.html">fantom::Algorithm::Progress</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">algorithm progress  <a href="classfantom_1_1Algorithm_1_1Progress.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfantom_1_1Algorithm.html">fantom::Algorithm</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">abstract base class of algorithms  <a href="classfantom_1_1Algorithm.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This part of the tutorial illustrates the basic abilities of algorithms to report status and ask the user simple questions. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;fantom/algorithm.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fantom/register.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacefantom.html">fantom</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>ReportingTutorialAlgorithm : <span class="keyword">public</span> <a class="code" href="classfantom_1_1DataAlgorithm.html">DataAlgorithm</a></div>
<div class="line">    {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        ReportingTutorialAlgorithm( InitData&amp; data )</div>
<div class="line">            : <a class="code" href="classfantom_1_1DataAlgorithm.html">DataAlgorithm</a>( data )</div>
<div class="line">        {</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">void</span> execute( <span class="keyword">const</span> <a class="code" href="classfantom_1_1Options.html">Algorithm::Options</a>&amp; <span class="comment">/*options*/</span>, <span class="keyword">const</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span>&amp; abortFlag )<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">        </span>{</div>
<div class="line">            <span class="keywordflow">if</span>( ask( <span class="stringliteral">&quot;Abort?&quot;</span> ) )</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error( <span class="stringliteral">&quot;Aborted.&quot;</span> );</div>
<div class="line"> </div>
<div class="line">            warningLog() &lt;&lt; <span class="stringliteral">&quot;Starting computation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">            debugLog() &lt;&lt; <span class="stringliteral">&quot;Starting.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">size_t</span> size = 100000000, total = 0;</div>
<div class="line">            <span class="keywordflow">for</span>( Progress i( *<span class="keyword">this</span>, <span class="stringliteral">&quot;computing&quot;</span>, size ); i != size &amp;&amp; !abortFlag; ++i )</div>
<div class="line">                total += rand() * i;</div>
<div class="line"> </div>
<div class="line">            debugLog() &lt;&lt; <span class="stringliteral">&quot;Finished.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">            infoLog() &lt;&lt; <span class="stringliteral">&quot;Totally Random: &quot;</span> &lt;&lt; total &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classfantom_1_1AlgorithmRegister.html">AlgorithmRegister&lt; ReportingTutorialAlgorithm &gt;</a> dummy( <span class="stringliteral">&quot;Tutorial/Reporting&quot;</span>, <span class="stringliteral">&quot;Demonstrate status reporting.&quot;</span> );</div>
<div class="line">}</div>
</div><!-- fragment --><p>When run, the algorithm shows some simple confirmation dialogs of various notification levels, emits some debug output, asks whether it should abort the algorithm, and performs a computation where the progress is reported through the GUI.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;fantom/algorithm.hpp&gt;</span></div>
</div><!-- fragment --><p>This includes some basic classes for writing FAnToM algorithms.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacefantom.html">fantom</a>;</div>
</div><!-- fragment --><p>Simply includes the namespace of FAnToM. The FAnToM API completely resides in this namespace.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
</div><!-- fragment --><p>This creates the anonymous namespace, where the rest of the code resides in. A FAnToM plugin does not need to export any symbols; to avoid potential problems with symbol resolving in the dynamic library loader, try to put everything into anonymous namespaces.</p>
<div class="fragment"><div class="line">    <span class="keyword">class </span>ReportingTutorialAlgorithm : <span class="keyword">public</span> DataAlgorithm</div>
<div class="line">    {</div>
</div><!-- fragment --><p>This declares a subclass of Algorithm called <em>ReportingTutorialAlgorithm</em>. Instances of FAnToM algorithms are objects rather than function calls, because this allows them to have state and arbitrary life-time to enable both interactivity and automatic disposal of created graphics and datasets. Details will be discussed in later sections of the tutorial.</p>
<div class="fragment"><div class="line">        ReportingTutorialAlgorithm( InitData&amp; data )</div>
<div class="line">            : DataAlgorithm( data )</div>
<div class="line">        {</div>
<div class="line">        }</div>
</div><!-- fragment --><p>This declares the algorithm's constructor, that contains algorithm setup. Interactive algorithms initialize views and manipulators here. Non-interactive algorithms usually do nothing beyond initializing persistent data members used for caching.</p>
<div class="fragment"><div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">void</span> execute( <span class="keyword">const</span> Algorithm::Options&amp; <span class="comment">/*options*/</span>, <span class="keyword">const</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span>&amp; abortFlag ) <span class="keyword">override</span></div>
</div><!-- fragment --><p>All work is performed inside the execute-function and functions called by it. The execution should check <em>abortFlag</em> once in a while and abort the execution when in becomes <code>true</code>. The abort flag should be handled without further interaction.</p>
<div class="fragment"><div class="line">            <span class="keywordflow">if</span>( ask( <span class="stringliteral">&quot;Abort?&quot;</span> ) )</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error( <span class="stringliteral">&quot;Aborted.&quot;</span> );</div>
</div><!-- fragment --><p>This produces a small dialog that asks the user a question ("Abort?"), that can be answered with "Yes" or "No". Such blocking interaction should be limited and should not be part of the standard algorithm behavior. For notifications, the blocking <code>warningLog()</code> and the non-blocking <code>infoLog()</code> should be used, instead. The algorithm blocks until the user has answered the question. Here, if the user answered the question with "Yes", the algorithm throws an exception. Any exception derived from std::exception is catched by the kernel and turned a small dialog. This is the recommended way to indicate an error. In the context of our example, answering "Yes" will stop the algorithm at this point. It is the responsibility of the programmer to leave the algorithm in a consistent state &ndash; in particular regarding the internal, persistent data structures. The execute-function is required be written exception-safe, i.e., throwing an exception at any time during the function will not leak any resources and optimally will have no side-effets at all.</p>
<div class="fragment"><div class="line">            warningLog() &lt;&lt; <span class="stringliteral">&quot;Starting computation.&quot;</span> &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>This produces a small dialog, which blocks the execution of the algorithm until it is accepted. It contains the message "Starting computation!", and the title of the message box should contain the originating algorithm's name. In general, such blocking warnings should be used only in severe cases and should not be part of the regular program flow.</p>
<div class="fragment"><div class="line">            debugLog() &lt;&lt; <span class="stringliteral">&quot;Starting.&quot;</span> &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>This emits "Starting!" preceeded by the algorithm's name on the console.</p>
<div class="fragment"><div class="line">            <span class="keywordtype">size_t</span> size = 100000000, total = 0;</div>
<div class="line">            <span class="keywordflow">for</span>( Progress i( *<span class="keyword">this</span>, <span class="stringliteral">&quot;computing&quot;</span>, size ); i != size &amp;&amp; !abortFlag; ++i )</div>
<div class="line">                total += rand() * i;</div>
</div><!-- fragment --><p>This loop performs an (arguably pointless) computation and illustrates progress reporting in FAnToM. Progress reporting is achieved by declaring a variable of type <code>Progress</code>, which is initialized with the current algorithm, the name of the phase, and the number of steps it comprises. Afterwards it may be used like any other variable of type <code>std::size_t</code>, i.e. compared, incremented, and used as argument for other functions. Note that a progress bar appears after accepting the warning dialog and automatically disappears when the <code>for</code> loop terminates. Use C++ scopes to define the life-time of a progress bar.</p>
<p>FAnToM supports a low-intrusive progress reporting, where progress variables are automatically registered and unregistered at the GUI and regularly polled. Changing the progress variable incurs no speed penalty. Note that you can have multiple progress variables active at once, in which case the GUI will show multiple progress bars grouped by algorithm.</p>
<div class="fragment"><div class="line">            debugLog() &lt;&lt; <span class="stringliteral">&quot;Finished.&quot;</span> &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>This emits "Finished!" preceeded by the algorithm's name on the console.</p>
<div class="fragment"><div class="line">            infoLog() &lt;&lt; <span class="stringliteral">&quot;Totally Random: &quot;</span> &lt;&lt; total &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>This produces another small dialog which blocks the execution of the algorithm until it is accepted. It shows the result of the computation using '\n' for multi-line messages. The member functions <code>debugLog()</code>, <code>infoLog()</code>, and <code>warningLog()</code> return objects that behave like <code>std::ostream</code>, e.g. <code>std::cout</code> and <code>std::cerr</code>. Compared to <code>std::cout</code> and <code>std::cerr</code>, there are advantages of using these members. First, when multiple algorithms are run concurrently, output using <code>std::cout</code> or <code>std::cerr</code> is typically garbled. In contrast, these special std::ostream's output are formated and printed on <code>std::flush</code> and <code>std::endl</code>, and the kernel guarantees that their printing does not interfere with each other. The kernel typically formats the message to indicate its origin, and the kernel may choose to present the messages in different ways, e.g., in a system without console, the kernel may put the debug messages in files or in parts of the main window, even perform all of these options. The kernel might also decide not to show debug messages at all. If FAnToM is run in a no-GUI version, all dialogs and progress reports are turned into messages to the console (or file) and <code>ask()</code> returns false. </p>
</div><!-- contents -->
<div class="ttc" id="aclassfantom_1_1AlgorithmRegister_html"><div class="ttname"><a href="classfantom_1_1AlgorithmRegister.html">fantom::AlgorithmRegister</a></div><div class="ttdoc">registers an algorithm at the kernel</div><div class="ttdef"><b>Definition:</b> algorithm.hpp:291</div></div>
<div class="ttc" id="anamespacefantom_html"><div class="ttname"><a href="namespacefantom.html">fantom</a></div><div class="ttdoc">FAnToM API namespace.</div><div class="ttdef"><b>Definition:</b> main.dox:37</div></div>
<div class="ttc" id="aclassfantom_1_1Options_html"><div class="ttname"><a href="classfantom_1_1Options.html">fantom::Options</a></div><div class="ttdoc">base class of options</div><div class="ttdef"><b>Definition:</b> options.hpp:119</div></div>
<div class="ttc" id="aclassfantom_1_1DataAlgorithm_html"><div class="ttname"><a href="classfantom_1_1DataAlgorithm.html">fantom::DataAlgorithm</a></div><div class="ttdoc">base class of data algorithms</div><div class="ttdef"><b>Definition:</b> algorithm.hpp:142</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
